<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Owl_nlp_corpus (owl.Owl_nlp_corpus)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">owl</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Owl_nlp_corpus</span></h1></header><p>NLP: Corpus module</p><div class="h7">Type definition</div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"><p>Type of a text corpus.</p></div></div><div class="h7">Query corpus</div><div class="spec val" id="val-length"><a href="#val-length" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>length : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p>Return the size of the corpus, i.e. number of documents.</p></div></div><div class="spec val" id="val-get"><a href="#val-get" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the ith document in the corpus.</p></div></div><div class="spec val" id="val-get_tok"><a href="#val-get_tok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_tok : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> int array</code></div><div class="doc"><p>Return the ith tokenised document in the corpus.</p></div></div><div class="spec val" id="val-get_uri"><a href="#val-get_uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_uri : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the path of the corpus.</p></div></div><div class="spec val" id="val-get_bin_uri"><a href="#val-get_bin_uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_bin_uri : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the path of the binary format of corpus.</p></div></div><div class="spec val" id="val-get_bin_fh"><a href="#val-get_bin_fh" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_bin_fh : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Pervasives.in_channel</code></div><div class="doc"><p>Return the file handle of the binary formation of corpus.</p></div></div><div class="spec val" id="val-get_tok_uri"><a href="#val-get_tok_uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_tok_uri : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the path of tokenised corpus.</p></div></div><div class="spec val" id="val-get_tok_fh"><a href="#val-get_tok_fh" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_tok_fh : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Pervasives.in_channel</code></div><div class="doc"><p>Return the file handle of the tokenised corpus.</p></div></div><div class="spec val" id="val-get_vocab_uri"><a href="#val-get_vocab_uri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_vocab_uri : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the path of vocabulary file associated with the corpus.</p></div></div><div class="spec val" id="val-get_vocab"><a href="#val-get_vocab" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_vocab : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a></code></div><div class="doc"><p>Return the vocabulary associated with the corpus.</p></div></div><div class="spec val" id="val-get_docid"><a href="#val-get_docid" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>get_docid : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int array</code></div><div class="doc"><p>Return a list of document ids which are mapped back to the original file where the corpus is built.</p></div></div><div class="h7">Iteration functions</div><div class="spec val" id="val-next"><a href="#val-next" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>next : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Return the next document in the corpus.</p></div></div><div class="spec val" id="val-next_tok"><a href="#val-next_tok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>next_tok : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int array</code></div><div class="doc"><p>Return the next tokenised document in the corpus.</p></div></div><div class="spec val" id="val-iteri"><a href="#val-iteri" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>iteri : (int <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Iterate all the documents in the corpus, the index (line number) is passed in.</p></div></div><div class="spec val" id="val-iteri_tok"><a href="#val-iteri_tok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>iteri_tok : (int <span class="keyword">&#8209;&gt;</span> int array <span class="keyword">&#8209;&gt;</span> unit) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Iterate the tokenised documents in the corpus, the index (line number) is passed in.</p></div></div><div class="spec val" id="val-mapi"><a href="#val-mapi" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mapi : (int <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span>) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> array</code></div><div class="doc"><p>Map all the documents in a corpus into another array. The index (line number) is passed in.</p></div></div><div class="spec val" id="val-mapi_tok"><a href="#val-mapi_tok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mapi_tok : (int <span class="keyword">&#8209;&gt;</span> <span class="type-var">'a</span> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span>) <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'b</span> array</code></div><div class="doc"><p>Map all the tokenised ocuments in a corpus into another array. The index (line number) is passed in.</p></div></div><div class="spec val" id="val-next_batch"><a href="#val-next_batch" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>next_batch : ?&#8288;size:int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string array</code></div><div class="doc"><p>Return the next batch of documents in a corpus as a string array. The default ``size`` is 100.</p></div></div><div class="spec val" id="val-next_batch_tok"><a href="#val-next_batch_tok" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>next_batch_tok : ?&#8288;size:int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int array array</code></div><div class="doc"><p>Return the next batch of tokenised documents in a corpus as a string array. The default ``size`` is 100.</p></div></div><div class="spec val" id="val-reset_iterators"><a href="#val-reset_iterators" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reset_iterators : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Reset the iterator to the begining of the corpus.</p></div></div><div class="h7">Core functions</div><div class="spec val" id="val-build"><a href="#val-build" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>build : ?&#8288;docid:int array <span class="keyword">&#8209;&gt;</span> ?&#8288;stopwords:(string, <span class="type-var">'a</span>) Hashtbl.t <span class="keyword">&#8209;&gt;</span> ?&#8288;lo:float <span class="keyword">&#8209;&gt;</span> ?&#8288;hi:float <span class="keyword">&#8209;&gt;</span> ?&#8288;vocab:<a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;minlen:int <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>This function builds up a corpus of type ``t`` from a given raw text corpus. We
assume that each line in the raw text corpus represents a document.</p><p>Parameters:
* ``?docid``: passed in ``docid`` can be used for tracking back to the original corpus, but this is not compulsory.
* ``?stopwords``: stopwords used in building vocabulary.
* ``?lo``: any word below this lower bound of the frequency is removed from vocabulary.
* ``?hi``: any word above this upper bound of the frequency is removed from vocabulary.
* ``?vocab``: an optional vocabulary, if it is not passed, the vocabulary is built from current corpus.
* ``?(minlen=10)``: threshold of the document length, any document shorter than this is removed from the corpus.
* ``fname``: the file name of the raw text corpus.</p></div></div><div class="spec val" id="val-tokenise"><a href="#val-tokenise" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>tokenise : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> int array</code></div><div class="doc"><p>``tokenise corpus doc`` tokenises the document ``doc`` using the ``corpus`` and its associated vocabulary.</p></div></div><div class="spec val" id="val-unique"><a href="#val-unique" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>unique : string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> int array</code></div><div class="doc"><p>Remove the duplicates in a text corpus, the ids of the removed files are returned.</p></div></div><div class="spec val" id="val-simple_process"><a href="#val-simple_process" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>simple_process : string <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>Function for simple pre-processing a given string.</p></div></div><div class="spec val" id="val-preprocess"><a href="#val-preprocess" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>preprocess : (string <span class="keyword">&#8209;&gt;</span> bytes) <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>``preprocess f input_file output_file`` pre-processes a given file
``input_file`` with the passed in function ``f`` then saves the output to
``output_file``.</p><p>E.g., you can plug in ``simple_process`` function to clean up the text. Note
this function will not change the number of lines in a corpus.</p></div></div><div class="h7">I/O functions</div><div class="spec val" id="val-save"><a href="#val-save" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>save : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Serialise the corpus and save it to a file of given name.</p></div></div><div class="spec val" id="val-load"><a href="#val-load" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>load : string <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Load a serialised corpus from a file.</p></div></div><div class="spec val" id="val-save_txt"><a href="#val-save_txt" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>save_txt : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Convert the tokenised corpus back to a text file</p></div></div><div class="spec val" id="val-to_string"><a href="#val-to_string" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>to_string : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> string</code></div><div class="doc"><p>The string representation of a corpus, contains the summary of a corpus.</p></div></div><div class="spec val" id="val-print"><a href="#val-print" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>print : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Pretty print the summary of a text corpus.</p></div></div><div class="h7">Helper functions</div><div class="spec val" id="val-create"><a href="#val-create" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>create : string <span class="keyword">&#8209;&gt;</span> int array <span class="keyword">&#8209;&gt;</span> int array <span class="keyword">&#8209;&gt;</span> Pervasives.in_channel option <span class="keyword">&#8209;&gt;</span> Pervasives.in_channel option <span class="keyword">&#8209;&gt;</span> <a href="../Owl_nlp_vocabulary/index.html#type-t">Owl_nlp_vocabulary.t</a> option <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> int array <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>```create uri bin_ofs tok_ofs bin_fh tok_fh vocab minlen docid` wraps up the
corpus into a record of type ``t``.</p></div></div><div class="spec val" id="val-reduce_model"><a href="#val-reduce_model" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reduce_model : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Set some fields to ``None`` so it can be safely serialised.</p></div></div><div class="spec val" id="val-cleanup"><a href="#val-cleanup" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>cleanup : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Close the opened file handles associated with the corpus.</p></div></div></body></html>